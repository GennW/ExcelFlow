git status
git add .
git commit -m "анализ БД для обновления поступающей информации"
git push



Glu#551255#


Сделай Чтобы корректно обработать ячейки со значениями-датами, если они заданы формулами в Excel (например, формула возвращает дату), скрипт должен:

1. **Читать вычисленные значения, а не формулы.**  
   Для этого при чтении Excel-файла использовать библиотеку, поддерживающую режим "data_only". В pandas — через openpyxl:
   - `load_workbook(filename, data_only=True)` — так значения ячеек будут числами, датами или строками, а не формулами.

2. **Анализировать столбец с датами на наличие дат:**
   - В полученном столбце "Дата приобретения" после загрузки искать значения:
     - Типа **datetime** или **Timestamp**.
     - Строкового типа, если строки соответствуют формату даты (например, `DD.MM.YYYY`).
     - Числового типа, если Excel сохраняет дату как число (например, 45000, это “датное число”).
   - Проверять, что значение не пустое (не NaN, None и не пустая строка).

3. **Считать количество ячеек с датой:**
   - Для каждой ячейки столбца — если после вычисления значение получилось датой любого из поддерживаемых типов (строка с датой, datetime, числовое представление даты), засчитать её как "дату".
   - Формулы, которые возвращают пусто, не считаются датой.

### Пример рабочего алгоритма:

- Загружаем Excel с помощью openpyxl (data_only=True).
- Ищем целевой столбец ("Дата приобретения").
- Для каждой ячейки столбца:
  - Если тип данных — `pd.Timestamp`, `datetime.datetime`, или содержимое ячейки соответствует шаблону даты (через регулярку), или ячейка — число, соответствующее Excel-датам — засчитываем как “ячейка с датой”.
- В конце считаем количество всех таких ячеек.

### Важно

- Если есть формулы, возвращающие даты, при неправильном сохранении файла Excel значения могут остаться формулами и не быть вычислены — в таком случае рекомендовано пересчитать формулы в Excel перед запуском скрипта (нажать `Ctrl+Alt+F9`, затем сохранить файл).

***

**В итоге:**  
Корректный скрипт должен анализировать именно **вычисленные значения** столбца "Дата приобретения" и считать ячейками с датой все те, что после вычисления содержат настоящее значение даты (а не формулы, текст “nan”, пусто и пр.).
результаты вывести в файл
потом сколько из них пустых (то есть по алгоритму как это делает excel при фильте выбрать пустые (регулярка на пробелы NAN и т.п.))